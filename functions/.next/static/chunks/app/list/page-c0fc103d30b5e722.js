(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{1023:(e,t,r)=>{"use strict";r.d(t,{db:()=>a,hJ:()=>c,j2:()=>i,xv:()=>l});var o=r(3915),n=r(5317),s=r(6203);let l=(0,o.Wp)({apiKey:"AIzaSyBs9aS_Y6T0BqKTEq-3ydqb_Rbzm3dte_k",authDomain:"travel-diary-6f691.firebaseapp.com",projectId:"travel-diary-6f691",storageBucket:"travel-diary-6f691.firebasestorage.app",messagingSenderId:"985967366781",appId:"1:985967366781:web:90eced8a356a5a9ef4d714",measurementId:"G-ZBT29L44G2"}),a=(0,n.aU)(l),i=(0,s.xI)(l),c=new s.HF},2120:(e,t,r)=>{"use strict";r.d(t,{T:()=>a});var o=r(2115),n=r(5317),s=r(1023),l=r(5091);let a=e=>{let{uid:t}=e,[r,a]=(0,o.useState)([]),[i,c]=(0,o.useState)(!0),{triggerAlert:d}=(0,l.M)(),h=(0,o.useCallback)(async()=>{try{if(!t)return void d("로그인이 필요합니다. 먼저 로그인해주세요!");c(!0);let e=(0,n.rJ)(s.db,"bookmarkData"),r=(0,n.P)(e,(0,n._M)("uid","==",t)),o=(await (0,n.GG)(r)).docs.map(e=>({_id:e.id,name:e.data().name,color:e.data().color}));a(o),c(!1)}catch(e){console.error("Firebase 북마크 불러오기 실패:",e)}},[t,d]);return(0,o.useEffect)(()=>{h()},[h]),{bookmarks:r,setBookmarks:a,fetchBookmarks:h,isLoading:i}}},3874:(e,t,r)=>{"use strict";r.d(t,{n:()=>l});var o=r(2115),n=r(5317),s=r(1023);let l=e=>{let{uid:t}=e,[r,l]=(0,o.useState)([]),[a,i]=(0,o.useState)(!0),c=async e=>{let{markerToSave:t}=e,r=(0,n.rJ)(s.db,"travelData"),o=await (0,n.gS)(r,{...t});await (0,n.mZ)(o,{_id:o.id});let a={...t,_id:o.id};l(e=>[...e,a])},d=async e=>{let{markerId:t,date:r,content:o,bookmark:a}=e,i=(0,n.H9)(s.db,"travelData",t);await (0,n.mZ)(i,{date:r,content:o,bookmark:{name:a.name,color:a.color}}),l(e=>e.map(e=>e._id===t?{...e,date:null!=r?r:e.date,content:o,bookmark:{_id:a._id,name:a.name,color:a.color}}:e))},h=(0,o.useCallback)(async()=>{if(!t)return;i(!0);let e=(0,n.rJ)(s.db,"travelData"),r=(0,n.P)(e,(0,n._M)("uid","==",t),(0,n.My)("date","desc"));l((await (0,n.GG)(r)).docs.map(e=>({...e.data(),date:e.data().date.toDate()}))),i(!1)},[t]),[u,p]=(0,o.useState)(!0),m=(0,o.useRef)(null),f=(0,o.useCallback)(async()=>{if(!t)return;i(!0);let e=(0,n.aU)(s.xv),r=(0,n.rJ)(e,"travelData"),o=(0,n.P)(r,(0,n._M)("uid","==",t),(0,n.My)("date","desc"),(0,n.AB)(10));m.current&&(o=(0,n.P)(r,(0,n._M)("uid","==",t),(0,n.My)("date","desc"),(0,n.HM)(m.current),(0,n.AB)(10)));let a=await (0,n.GG)(o);if(a.empty)p(!1);else{let e=a.docs.map(e=>({...e.data(),date:e.data().date.toDate()}));l(t=>[...t,...e]),m.current=a.docs[a.docs.length-1],a.docs.length<10&&p(!1)}i(!1)},[t]);return(0,o.useEffect)(()=>{f()},[f]),{markers:r,createMarker:c,updateMarker:d,fetchMarkers:h,fetchMoreMarkers:f,isLoading:a,hasMore:u}}},5091:(e,t,r)=>{"use strict";r.d(t,{M:()=>n});var o=r(2115);function n(){let[e,t]=(0,o.useState)(!1),[r,n]=(0,o.useState)("");return{showAlert:e,alertValue:r,triggerAlert:(0,o.useCallback)(e=>{n(e),t(!0),setTimeout(()=>{t(!1)},2e3)},[])}}},6681:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var o=r(2115),n=r(6203),s=r(1023);let l=()=>{let[e,t]=(0,o.useState)(null),r=null==e?void 0:e.uid;return(0,o.useEffect)(()=>{let e=(0,n.hg)(s.j2,e=>{null!==e?t(e):t(null)});return()=>{e()}},[]),{user:e,uid:r,handleLogin:async()=>{try{await (0,n.df)(s.j2,s.hJ)}catch(e){console.error("로그인 실패:",e)}},handleLogout:async()=>{try{await s.j2.signOut()}catch(e){console.error("로그아웃 실패:",e)}}}}},8268:(e,t,r)=>{Promise.resolve().then(r.bind(r,9353))},9353:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>T});var o=r(5155),n=r(2115),s=r(6681),l=r(2120),a=r(9434);function i(e){let{className:t,...r}=e;return(0,o.jsx)("div",{"data-slot":"skeleton",className:(0,a.cn)("bg-accent animate-pulse rounded-md",t),...r})}function c(e){let{className:t,...r}=e;return(0,o.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function d(e){let{className:t,...r}=e;return(0,o.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...r})}function h(e){let{uid:t,selectedBookmark:r,setSelectedBookmark:s}=e,{bookmarks:a,isLoading:h}=(0,l.T)({uid:t});return(0,n.useEffect)(()=>{a.length>0&&s(a[0].name)},[a,s]),(0,o.jsx)("div",{className:"fixed flex gap-4 w-full px-8 py-4 bg-white border-b",children:h?(0,o.jsx)("div",{className:"flex gap-5",children:[1,2].map(e=>(0,o.jsx)(i,{className:"w-19 h-10 rounded-md"},e))}):a.map(e=>(0,o.jsx)(c,{onClick:()=>s(e.name),className:"min-w-10 px-4 py-2 cursor-pointer text-center ".concat(r===e.name?"border-blue-500 bg-blue-50":""),children:(0,o.jsx)(d,{className:"p-0",children:e.name})},e.name))})}var u=r(3874),p=function(e,t){return(p=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},m=function(){return(m=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},f={Pixel:"Pixel",Percent:"Percent"},g={unit:f.Percent,value:.8};function v(e){return"number"==typeof e?{unit:f.Percent,value:100*e}:"string"==typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:f.Pixel,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:f.Percent,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),g):(console.warn("scrollThreshold should be string or number"),g)}var y=function(e){function t(){this.constructor=r}function r(t){var r=e.call(this,t)||this;return r.lastScrollTop=0,r.actionTriggered=!1,r.startY=0,r.currentY=0,r.dragging=!1,r.maxPullDownDistance=0,r.getScrollableTarget=function(){return r.props.scrollableTarget instanceof HTMLElement?r.props.scrollableTarget:"string"==typeof r.props.scrollableTarget?document.getElementById(r.props.scrollableTarget):(null===r.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},r.onStart=function(e){!r.lastScrollTop&&(r.dragging=!0,e instanceof MouseEvent?r.startY=e.pageY:e instanceof TouchEvent&&(r.startY=e.touches[0].pageY),r.currentY=r.startY,r._infScroll&&(r._infScroll.style.willChange="transform",r._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},r.onMove=function(e){if(r.dragging)e instanceof MouseEvent?r.currentY=e.pageY:e instanceof TouchEvent&&(r.currentY=e.touches[0].pageY),r.currentY<r.startY||(r.currentY-r.startY>=Number(r.props.pullDownToRefreshThreshold)&&r.setState({pullToRefreshThresholdBreached:!0}),!(r.currentY-r.startY>1.5*r.maxPullDownDistance)&&r._infScroll&&(r._infScroll.style.overflow="visible",r._infScroll.style.transform="translate3d(0px, "+(r.currentY-r.startY)+"px, 0px)"))},r.onEnd=function(){r.startY=0,r.currentY=0,r.dragging=!1,r.state.pullToRefreshThresholdBreached&&(r.props.refreshFunction&&r.props.refreshFunction(),r.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){r._infScroll&&(r._infScroll.style.overflow="auto",r._infScroll.style.transform="none",r._infScroll.style.willChange="unset")})},r.onScrollListener=function(e){"function"==typeof r.props.onScroll&&setTimeout(function(){return r.props.onScroll&&r.props.onScroll(e)},0);var t=r.props.height||r._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;r.actionTriggered||((r.props.inverse?r.isElementAtTop(t,r.props.scrollThreshold):r.isElementAtBottom(t,r.props.scrollThreshold))&&r.props.hasMore&&(r.actionTriggered=!0,r.setState({showLoader:!0}),r.props.next&&r.props.next()),r.lastScrollTop=t.scrollTop)},r.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},r.throttledOnScrollListener=(function(e,t,r,o){var n,s=!1,l=0;function a(){n&&clearTimeout(n)}function i(){var i=this,c=Date.now()-l,d=arguments;function h(){l=Date.now(),r.apply(i,d)}s||(o&&!n&&h(),a(),void 0===o&&c>e?h():!0!==t&&(n=setTimeout(o?function(){n=void 0}:h,void 0===o?e-c:e)))}return"boolean"!=typeof t&&(o=r,r=t,t=void 0),i.cancel=function(){a(),s=!0},i})(150,r.onScrollListener).bind(r),r.onStart=r.onStart.bind(r),r.onMove=r.onMove.bind(r),r.onEnd=r.onEnd.bind(r),r}return p(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t),r.prototype.componentDidMount=function(){if(void 0===this.props.dataLength)throw Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"==typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!=typeof this.props.refreshFunction))throw Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},r.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},r.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},r.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?m(m({},t),{prevDataLength:e.dataLength}):null},r.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var r=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,o=v(t);return o.unit===f.Pixel?e.scrollTop<=o.value+r-e.scrollHeight+1:e.scrollTop<=o.value/100+r-e.scrollHeight+1},r.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var r=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,o=v(t);return o.unit===f.Pixel?e.scrollTop+r>=e.scrollHeight-o.value:e.scrollTop+r>=o.value/100*e.scrollHeight},r.prototype.render=function(){var e=this,t=m({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),r=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),o=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return n.createElement("div",{style:o,className:"infinite-scroll-component__outerdiv"},n.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&n.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},n.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!r&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},r}(n.Component),x=r(3008);function b(e){let{uid:t,selectedBookmark:r}=e,{markers:s,isLoading:l,fetchMoreMarkers:a,hasMore:h}=(0,u.n)({uid:t}),p=(0,n.useMemo)(()=>s.filter(e=>r===e.bookmark.name),[s,r]);console.log("filteredMarkers: ",p);let m=(0,n.useMemo)(()=>Array.from(new Set(p.map(e=>(0,x.GP)(e.date,"yyyy-MM-dd")))),[p]);return(0,o.jsx)("div",{className:"max-h-160 pt-24 px-8",children:l?(0,o.jsx)("div",{className:"space-y-6",children:[1,2,3].map(e=>(0,o.jsx)(i,{className:"h-49 w-full rounded-lg"},e))}):0===m.length?(0,o.jsx)("div",{className:"size-full",children:"기록이 없습니다."}):(0,o.jsx)("div",{id:"scroll-container",className:"h-full rounded-md",children:(0,o.jsx)(y,{dataLength:p.length,next:a,hasMore:h,loader:(0,o.jsx)("h4",{children:"Loading..."}),children:m.map(e=>(0,o.jsxs)("div",{className:"flex gap-x-8 gap-y-4 px-8 py-5 bg-[#FAFAF2] border border-[#9A8C4B] rounded-md   mt-8 first:mt-0 last:mb-8   flex-col sm:flex-row",children:[(0,o.jsx)("div",{className:"w-23 mt-1 shrink-0",children:e}),(0,o.jsx)("div",{className:"w-full",children:p.filter(t=>(0,x.GP)(t.date,"yyyy-MM-dd")===e).map(e=>(0,o.jsx)(c,{className:"mt-6 py-5 first:mt-0",children:(0,o.jsx)(d,{className:"px-8 sm:px-12",children:(0,o.jsxs)("div",{className:"flex flex-col gap-3 items-start",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-base whitespace-pre-line",children:e.name}),(0,o.jsx)("span",{className:"text-xs text-muted-foreground font-medium",children:e.address})]}),(0,o.jsx)("p",{children:e.content})]})})},"".concat(e._id)))})]},"".concat(e)))})})})}function w(){let{uid:e}=(0,s.A)(),[t,r]=(0,n.useState)("");return(0,o.jsxs)("article",{className:"flex flex-col gap-6 h-full",children:[(0,o.jsx)(h,{uid:e,selectedBookmark:t,setSelectedBookmark:r}),(0,o.jsx)(b,{uid:e,selectedBookmark:t})]})}function T(){return(0,o.jsx)(w,{})}},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var o=r(2596),n=r(9688);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,o.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,965,277,645,8,441,684,358],()=>t(8268)),_N_E=e.O()}]);